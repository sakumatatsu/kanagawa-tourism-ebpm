# 神奈川県観光振興EBPMダッシュボード 開発記録

## プロジェクト概要

- **目的**: 神奈川県の観光振興施策をEBPM（Evidence-Based Policy Making）の観点から高度化するためのダッシュボード構築
- **背景**: 神奈川県が総合計画（新かながわグランドデザイン）の見直しを控えており、観光振興の現状を多角的・定量的に把握する必要がある
- **利用者**: 神奈川県庁の観光振興担当職員
- **公開URL**: https://sakumatatsu.github.io/kanagawa-tourism-ebpm/
- **リポジトリ**: https://github.com/sakumatatsu/kanagawa-tourism-ebpm

---

## Day 1: 2026年2月22日（土）

### 実施内容

#### フェーズ1: 要件定義（23:50〜00:01）
ユーザーとの対話形式で9つの設計質問を通じて要件を確定。

- **アウトプット形態**: Webダッシュボード（スタンドアロンHTML）、将来的にBIツール連携
- **利用者**: 県庁観光振興担当職員
- **対象範囲**: 全県横断（横浜・鎌倉・箱根・湘南・三浦等の7エリア）
- **データ更新**: 当面は静的データ、将来的に定期更新
- **アウトカム指標**: 総合計画見直し前のため幅広く総合的に把握
- **因数分解の切り口**: 施策・事業別（最優先）、地域別、観光資源タイプ別、旅行者属性別
- **ベース計画**: 新かながわグランドデザイン PJ5（観光・地域活性化）
- **可視化方式**: サンバーストチャート（ツリーマップより階層表現に優れる）
- **UXコンセプト**: 「思考フローに沿ったドリルダウン」— ユーザーが切り口を選択→構成要素を掘り下げ→利用可能データが明らかになる

#### フェーズ2: 計画策定・調査（00:01〜00:17）
- 新かながわグランドデザインのPJ5構造を調査
  - 3本の柱（A: 観光の振興、B: 地域にひとの流れ、C: 移住・定住）を特定
  - 各施策のKPI・数値目標を収集
- `PLAN.md` を作成（ロジックモデル、UI/UX設計、技術スタック、ファイル構成、実装フェーズ）

#### フェーズ3: データソース調査（00:17〜00:34）
ユーザーからの要望で、グランドデザイン記載データ以外の統計データを幅広く追加。3つの調査エージェントを並行実行:

1. **e-Stat統計データ調査** → 30以上の国の公的統計を特定、神奈川県での利用可否・粒度・API情報を整理
2. **神奈川県独自公表データ調査** → 入込観光客調査、観光客実態調査、経済波及効果分析ツール、県勢要覧等を特定
3. **民間人流・消費データ調査** → モバイル空間統計、Agoop、JCB消費NOW、各鉄道会社の乗降データ等40以上のソースを調査

成果物:
- `e-Stat統計データ調査報告書.md`（32,162 bytes）
- `data_sources_survey.md`（48,711 bytes）
- `DATA_SOURCES.md`（23,362 bytes）

#### フェーズ4: ダッシュボード実装（00:31〜00:40）
4ファイル構成でフルスクラッチ実装:

- `index.html` — メインHTML（ヘッダー、KPIサマリー、切り口タブ、サンバーストチャート、データソースカタログ）
- `js/data.js` — 全データ定義（4つの因数分解ツリー、50以上のデータソース、KPI目標値）
- `js/app.js` — D3.js v7によるサンバーストチャート、インタラクティブUI、詳細パネル
- `css/style.css` — レスポンシブ対応スタイリング

#### フェーズ5: KPI連動機能の実装（00:40〜00:56）
ユーザーからのフィードバック: 「最上位KPIサマリーとサンバーストチャートが切り離されている」

対応:
- KPI×切り口の対応マッピング（`kpiPerspectiveMapping`）をデータに追加
- `renderKPISummary()` を拡張し、切り口選択時に構成比スタックドバーを表示
- 対応データがないKPIカードを半透明化（「この切り口では分解不可」を視覚表示）
- サンバースト要素クリック時の貢献度バッジ表示（値と割合）
- 構成比バーのセグメント色をサンバーストと統一

#### フェーズ6: GitHub Pagesデプロイ（01:01〜01:18, 05:13〜05:18）
- GitHub CLI (gh) をインストール（Homebrewはsudo権限不足のため直接バイナリダウンロード）
- GitHubアカウント認証（ブラウザ経由のOAuthデバイスフロー）
- publicリポジトリ `kanagawa-tourism-ebpm` を作成・push
- GitHub Actions ワークフロー（`deploy.yml`）を追加
- workflowスコープの追加認証を実施
- GitHub Pages でのデプロイ完了を確認

### Day 1 時点の成果物

| ファイル | 行数 | 概要 |
|---------|------|------|
| `index.html` | 95行 | メインHTML構造 |
| `js/app.js` | 771行 | アプリケーションロジック（D3サンバースト、KPI連動、インタラクション） |
| `js/data.js` | 777行 | 全データ定義（因数分解ツリー×4切り口、50+データソース、KPIマッピング） |
| `css/style.css` | 830行 | スタイルシート（レスポンシブ対応、KPI連動用スタイル含む） |
| `.github/workflows/deploy.yml` | 34行 | GitHub Pages自動デプロイ |
| `PLAN.md` | — | プロジェクト計画書 |
| `DATA_SOURCES.md` | — | 神奈川県固有データソース調査結果 |
| `data_sources_survey.md` | — | 民間・準公的データソース調査結果 |
| `e-Stat統計データ調査報告書.md` | — | e-Stat統計データ調査結果 |

### Day 1 時点の機能一覧

- [x] 最上位KPIサマリー（観光消費額・入込客数・宿泊者数・満足度の4指標）
- [x] 4つの因数分解切り口（施策・事業別 / 地域別 / 観光資源タイプ別 / 旅行者属性別）
- [x] D3.jsサンバーストチャートによる階層的可視化
- [x] クリックによるドリルダウン（パンくずリスト連動）
- [x] 詳細パネル（KPI目標値、利用可能データソース一覧）
- [x] KPIサマリーと切り口の連動（構成比バー、貢献度バッジ、dimmed表示）
- [x] データソースカタログ（9カテゴリ、54データソース）
- [x] ツールチップ（ホバー時の情報表示）
- [x] レスポンシブデザイン（1024px / 768px / 480px ブレークポイント）
- [x] GitHub Pagesによる外部公開

---

## 今後の開発予定（未着手）

- [ ] 実データの投入（現在は静的なサンプルデータ）
- [ ] e-Stat API連携による自動データ取得
- [ ] 時系列トレンドグラフの追加
- [ ] データのエクスポート機能（CSV/Excel）
- [ ] アクセス制限の導入（メンバー限定公開）
- [ ] クラウドホスティングへの移行
- [ ] BIツール（Tableau/Power BI等）との連携設計
